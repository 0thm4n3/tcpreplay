.\" $Id: tcpreplay.8,v 1.3 2003/05/07 17:46:25 aturner Exp $
.TH TCPREPLAY 8
.SH NAME
tcpreplay \- replay packets from capture files
.SH SYNOPSIS
.na
.B tcpreplay
.B \-i
.I intf
[
.B \-c
.I cache file
] [
.B \-f
.I config file
] [ 
.B \-I
.I intf mac
] [
.B \-j
.I intf2
] [
.B \-J
.I intf mac
] [
.B \-l
.I loop count
] [
.B \-m
.I multiplier
|
.B \-r
.I rate
|
.B \-R
|
.B \-p
.I pause
] [
.B \-P
] [
.B \-s
.I seed
] [
.B \-C 
CIDR...
] [
.B \-u pad|trunc
] [
.B \-v
] [
.B \-h|-V
] [
.B \-M
] [
.B \-x
.I include
|
.B \-X
.I exclude
] [
.B \-2 l2datafile
]
.I file ...
.SH DESCRIPTION
.LP
.I tcpreplay
is a tool for replaying network traffic from files saved with 
\fItcpdump(8)\fP.
.LP
The basic operation of
.I tcpreplay
is to resend all packets from input file(s) at the speed at which
they were recorded, a specified data \fIrate\fP, or as fast as the hardware is 
capable.  
.LP
If no
\fIrate\fP or
\fImultiplier\fP are given, 
.I tcpreplay 
will replay packets at the speed they were captured from the wire.
.LP
By processing a \fIcache file\fP generated by \fItcpprep(8)\fP, tcpreplay 
is able to split traffic between two interfaces.  This is useful for testing 
bridges, routers, and other gateway devices. Also supported is the rewriting of 
destination \fIMAC addresses\fP to allow routers and other devices which 
proxy-arp to forward packets.
.SH OPTIONS
.LP
.TP
.B \-f 
Specify a file that contains configuration options. 
Option tokens are listed below next to the corresponding command-line flag.
.TP
.B \-c or "cachefile"
Specify the \fItcpprep cache\fR to use to process packets.
.TP
.B \-h
Prints help/usage
.TP
.B \-i or "intf"
Specify the interface in which to send packets.
.TP
.B \-I or "primary_mac"
Specify the \fIdestination MAC\fR to use for packets being sent out the primary
interface.
.TP
.B \-j or "second_intf"
Specify the \fIsecondary interface\fR in which to send packets.
.TP
.B \-J or "second_mac"
Specify the \fIdestination MAC\fR to use for packets being sent out the 
secondary interface.
.TP
.B \-l or "loop"
Resend the capture file(s) \fIloop count\fR times.  Setting this to 0 (zero)
will cause tcpreplay to loop infinitely.
.TP
.B \-m or "multiplier"
Resend the packets at a \fImultiple\fR of the speed at which they were
recorded, specified as a floating-point number.
.TP
.B \-M or "no_martians"
Disable sending martian packets (source networks: 0/8, 127/8, 255/8)
.TP
.B \-p or "pause"
Specify the number of seconds and microseconds (sec.usec) to pause between 
each packet.  Negates all other speed options.
.TP
.B \-P
.br
Print the PID of the tcpreplay process at startup.  Useful when wanting to
use SIGUSR1 and SIGCONT to pause/restart.
.TP
.B \-r or "rate"
Resend the packets at \fIrate\fR megabits per-second, specified as a 
floating-point number.
.TP
.B \-C or "cidr"
Given a list of CIDR networks, packets with a source address matching an 
entry in the list are sent out the primary interface. All other packets
are sent via the secondary interface. CIDR lists are comma-separated 
and do not contain spaces, \fI192.168.0.0/28,10.0.0.0/16\fR and 
\fI10.1.1.0/29\fR, for example. Overrides the -c option. 
.TP
.B \-R or "topspeed"
Resend the packets as fast as possible. Negates all other speed options.
.TP
.B \-s or "seed"
Specify a seed value to allow rewriting the source and destination IP
addresses (only in IP header) to pseudo-random values.  Will also recalculate 
the IP header as necessary.
.TP
.B \-u or "untruncate"
When a packet is truncated in the capture file, this option will
\fIpad\fR the end of the packet with zeros, or truncate (\fItrunc\fR) 
it by re-adjusting the length in the IP header. The \fItrunc\fR
option will only alter IPv4 packets, all others will be sent unmodified.
.TP
.B \-v or "verbose"
.br
Verbose mode, currently unused.
.TP
.B \-V
Print version info and exit.
.TP
.B \-x or "include"
Specifies which packets from the capture file(s) to send.  Can be one of:
.br
.br
S:<CIDR1>,... - Src IP must match specified CIDR(s)
.br
D:<CIDR1>,... - Dst IP must match specified CIDR(s)
.br
B:<CIDR1>,... - Both src and dst addresses must match
.br
E:<CIDR1>,... - Either src or dst address must match
.br
P:<list>      - Must be one of the listed packets where the list corresponds to the
packet number in the capture file.  Ex: -x P:1-5,9,15 would only send packets 1 
through 5, 9 and 15.
.TP
.B \-X or "exclude"
Specifies which packets from the capture file(s) to NOT send.  Can be one of:
.br
S:<CIDR1>,... - Src IP must match specified CIDR(s)
.br
D:<CIDR1>,... - Dst IP must match specified CIDR(s)
.br
B:<CIDR1>,... - Both src and dst addresses must match
.br
E:<CIDR1>,... - Either src or dst address must match
.br
P:<list>      - Must be one of the listed packets where the list corresponds to the
packet number in the capture file.  Ex: -X P:1-5,9,15 would send all packets except 1 
through 5, 9 and 15.
.TP
.B \-2 or l2datafile
Specifies a file containing the Layer 2 header to use instead of the Layer 2 header
in the packet.  Useful for converting between 802.x types or adding a header when
the pcap file doesn't contain a header (as in the case of DLT_RAW).
.SH SIGNALS
.I Tcpreplay
understands the following signals:
.TP
.B SIGUSR1
Suspend tcpreplay.
.TP
.B SIGCONT
Restart tcpreplay after it has been suspended.
.SH "SEE ALSO"
tcpdump(8), snoop(1M), tcpprep(1), capinfo(1)
.SH AUTHORS
Matt Undy, Anzen Computing.
.br
Matt Bing <mbing@nfr.net>
.br
Aaron Turner <aturner@pobox.com>
.SH AVAILABILITY
.LP
The current version is available via HTTP:
.LP
.RS
.I http://www.sourceforge.net/projects/tcpreplay/
.RE
.SH LIMITATIONS
Please see the tcpreplay FAQ for a list of limitations and any possible
work-arounds:
.I http://tcpreplay.sourceforge.net/FAQ.html
